\hypertarget{cli_8c}{\section{/\-Users/kiskele/\-Dropbox/suli/mptcp/source/src/mptlib/cli.c File Reference}
\label{cli_8c}\index{/\-Users/kiskele/\-Dropbox/suli/mptcp/source/src/mptlib/cli.\-c@{/\-Users/kiskele/\-Dropbox/suli/mptcp/source/src/mptlib/cli.\-c}}
}


This file is used to check C\-L\-I commands and their parameters.  


{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$regex.\-h$>$}\\*
{\ttfamily \#include $<$arpa/inet.\-h$>$}\\*
{\ttfamily \#include \char`\"{}cli.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}multipath.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mp\-\_\-local.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}../include/cmd.\-def\char`\"{}}\\*
Include dependency graph for cli.\-c\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cli_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{cli_8c_a3e2a9ab056b5287fb088194ee7ecd789}{\#define {\bfseries C\-L\-I\-\_\-\-C\-O\-M\-M\-A\-N\-D}(name, regex)~regex,}\label{cli_8c_a3e2a9ab056b5287fb088194ee7ecd789}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{cli_8c_a51f6e63945679154f6764eb315841011}{mpt\-\_\-int\-\_\-constructor} (struct \hyperlink{structmpt__int}{mpt\-\_\-int} $\ast$$\ast$this)
\item 
void \hyperlink{cli_8c_a9643da81bdc75e4fbba500e2a6dff5e8}{mpt\-\_\-int\-\_\-destructor} (struct \hyperlink{structmpt__int}{mpt\-\_\-int} $\ast$$\ast$this)
\item 
void \hyperlink{cli_8c_a2a13ff49bfb39fc0dc560d1319eae1cf}{mpt\-\_\-addr\-\_\-constructor} (struct \hyperlink{structmpt__addr}{mpt\-\_\-addr} $\ast$$\ast$this)
\item 
void \hyperlink{cli_8c_a0d3db8f968fb1b8ba6c7512ee99d9d5d}{mpt\-\_\-addr\-\_\-destructor} (struct \hyperlink{structmpt__addr}{mpt\-\_\-addr} $\ast$$\ast$this)
\item 
void \hyperlink{cli_8c_a532a1f844e5d510e8d95df91c333539a}{mpt\-\_\-change\-\_\-path\-\_\-constructor} (struct \hyperlink{structmpt__change__path}{mpt\-\_\-change\-\_\-path} $\ast$$\ast$this)
\item 
void \hyperlink{cli_8c_a35e0294c0da40584ba1c99b230dae290}{mpt\-\_\-change\-\_\-path\-\_\-destructor} (struct \hyperlink{structmpt__change__path}{mpt\-\_\-change\-\_\-path} $\ast$$\ast$this)
\item 
void \hyperlink{cli_8c_a4db0479001a6794462fb24b12192d397}{save\-\_\-match} (char $\ast$$\ast$dst, char $\ast$src, regmatch\-\_\-t pmatch)
\item 
int \hyperlink{cli_8c_acc286b66b5b52e4d8d11e5f6990ce425}{parser} (char $\ast$cmd, \hyperlink{cli_8h_a8772ddb837dae62899db0754b7606766}{C\-M\-D\-T\-Y\-P\-E} $\ast$rettype, void $\ast$$\ast$ret)
\item 
int \hyperlink{cli_8c_ad8c4dc93e9bc191c65d5616602599ffd}{parse\-\_\-cmd} (char $\ast$cmd)
\item 
int \hyperlink{cli_8c_ad277b46a2c0363cc077beb9f9d41e6d2}{exec\-\_\-cmd} (char $\ast$cmd, int sock, struct sockaddr $\ast$client, unsigned int csize)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
This file is used to check C\-L\-I commands and their parameters. \begin{DoxyAuthor}{Author}
Kelemen Tamas \href{mailto:kiskele@krc.hu}{\tt kiskele@krc.\-hu} 
\end{DoxyAuthor}


Definition in file \hyperlink{cli_8c_source}{cli.\-c}.



\subsection{Function Documentation}
\hypertarget{cli_8c_ad277b46a2c0363cc077beb9f9d41e6d2}{\index{cli.\-c@{cli.\-c}!exec\-\_\-cmd@{exec\-\_\-cmd}}
\index{exec\-\_\-cmd@{exec\-\_\-cmd}!cli.c@{cli.\-c}}
\subsubsection[{exec\-\_\-cmd}]{\setlength{\rightskip}{0pt plus 5cm}int exec\-\_\-cmd (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{cmd, }
\item[{int}]{sock, }
\item[{struct sockaddr $\ast$}]{client, }
\item[{unsigned int}]{csize}
\end{DoxyParamCaption}
)}}\label{cli_8c_ad277b46a2c0363cc077beb9f9d41e6d2}
Check C\-L\-I command syntax on server side and execute that \begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000004}{Todo}]Check result of commands and if something went wrong return an error code and put some explanation in cmd parameter.\end{DoxyRefDesc}



\begin{DoxyParams}{Parameters}
{\em cmd} & C\-L\-I command received \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Execution of command failed or succeeded 
\end{DoxyReturn}


Definition at line 360 of file cli.\-c.

\hypertarget{cli_8c_a2a13ff49bfb39fc0dc560d1319eae1cf}{\index{cli.\-c@{cli.\-c}!mpt\-\_\-addr\-\_\-constructor@{mpt\-\_\-addr\-\_\-constructor}}
\index{mpt\-\_\-addr\-\_\-constructor@{mpt\-\_\-addr\-\_\-constructor}!cli.c@{cli.\-c}}
\subsubsection[{mpt\-\_\-addr\-\_\-constructor}]{\setlength{\rightskip}{0pt plus 5cm}void mpt\-\_\-addr\-\_\-constructor (
\begin{DoxyParamCaption}
\item[{struct {\bf mpt\-\_\-addr} $\ast$$\ast$}]{this}
\end{DoxyParamCaption}
)}}\label{cli_8c_a2a13ff49bfb39fc0dc560d1319eae1cf}
Constructor that allocates memory and initializes the structure of \char`\"{}address add$|$del\char`\"{} command

\begin{DoxyNote}{Note}
This memory needs to deallocate after use. Use \hyperlink{cli_8c_a0d3db8f968fb1b8ba6c7512ee99d9d5d}{mpt\-\_\-addr\-\_\-destructor()}
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em this} & Pointer to an \char`\"{}mpt\-\_\-addr $\ast$\char`\"{} variable \\
\hline
\end{DoxyParams}


Definition at line 53 of file cli.\-c.

\hypertarget{cli_8c_a0d3db8f968fb1b8ba6c7512ee99d9d5d}{\index{cli.\-c@{cli.\-c}!mpt\-\_\-addr\-\_\-destructor@{mpt\-\_\-addr\-\_\-destructor}}
\index{mpt\-\_\-addr\-\_\-destructor@{mpt\-\_\-addr\-\_\-destructor}!cli.c@{cli.\-c}}
\subsubsection[{mpt\-\_\-addr\-\_\-destructor}]{\setlength{\rightskip}{0pt plus 5cm}void mpt\-\_\-addr\-\_\-destructor (
\begin{DoxyParamCaption}
\item[{struct {\bf mpt\-\_\-addr} $\ast$$\ast$}]{this}
\end{DoxyParamCaption}
)}}\label{cli_8c_a0d3db8f968fb1b8ba6c7512ee99d9d5d}
Destructor that deallocates memory after struct \hyperlink{structmpt__addr}{mpt\-\_\-addr} $\ast$ is no longer needed


\begin{DoxyParams}{Parameters}
{\em this} & Pointer to an \char`\"{}mpt\-\_\-addr $\ast$\char`\"{} variable \\
\hline
\end{DoxyParams}


Definition at line 66 of file cli.\-c.

\hypertarget{cli_8c_a532a1f844e5d510e8d95df91c333539a}{\index{cli.\-c@{cli.\-c}!mpt\-\_\-change\-\_\-path\-\_\-constructor@{mpt\-\_\-change\-\_\-path\-\_\-constructor}}
\index{mpt\-\_\-change\-\_\-path\-\_\-constructor@{mpt\-\_\-change\-\_\-path\-\_\-constructor}!cli.c@{cli.\-c}}
\subsubsection[{mpt\-\_\-change\-\_\-path\-\_\-constructor}]{\setlength{\rightskip}{0pt plus 5cm}void mpt\-\_\-change\-\_\-path\-\_\-constructor (
\begin{DoxyParamCaption}
\item[{struct {\bf mpt\-\_\-change\-\_\-path} $\ast$$\ast$}]{this}
\end{DoxyParamCaption}
)}}\label{cli_8c_a532a1f844e5d510e8d95df91c333539a}
Constructor that allocates memory and initializes the structure of \char`\"{}path up$|$down\char`\"{} command

\begin{DoxyNote}{Note}
This memory needs to deallocate after use. Use \hyperlink{cli_8c_a35e0294c0da40584ba1c99b230dae290}{mpt\-\_\-change\-\_\-path\-\_\-destructor()}
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em this} & Pointer to an \char`\"{}mpt\-\_\-change\-\_\-path $\ast$\char`\"{} variable \\
\hline
\end{DoxyParams}


Definition at line 83 of file cli.\-c.

\hypertarget{cli_8c_a35e0294c0da40584ba1c99b230dae290}{\index{cli.\-c@{cli.\-c}!mpt\-\_\-change\-\_\-path\-\_\-destructor@{mpt\-\_\-change\-\_\-path\-\_\-destructor}}
\index{mpt\-\_\-change\-\_\-path\-\_\-destructor@{mpt\-\_\-change\-\_\-path\-\_\-destructor}!cli.c@{cli.\-c}}
\subsubsection[{mpt\-\_\-change\-\_\-path\-\_\-destructor}]{\setlength{\rightskip}{0pt plus 5cm}void mpt\-\_\-change\-\_\-path\-\_\-destructor (
\begin{DoxyParamCaption}
\item[{struct {\bf mpt\-\_\-change\-\_\-path} $\ast$$\ast$}]{this}
\end{DoxyParamCaption}
)}}\label{cli_8c_a35e0294c0da40584ba1c99b230dae290}
Destructor that deallocates memory after struct \hyperlink{structmpt__change__path}{mpt\-\_\-change\-\_\-path} $\ast$ is no longer needed


\begin{DoxyParams}{Parameters}
{\em this} & Pointer to an \char`\"{}mpt\-\_\-change\-\_\-path $\ast$\char`\"{} variable \\
\hline
\end{DoxyParams}


Definition at line 95 of file cli.\-c.

\hypertarget{cli_8c_a51f6e63945679154f6764eb315841011}{\index{cli.\-c@{cli.\-c}!mpt\-\_\-int\-\_\-constructor@{mpt\-\_\-int\-\_\-constructor}}
\index{mpt\-\_\-int\-\_\-constructor@{mpt\-\_\-int\-\_\-constructor}!cli.c@{cli.\-c}}
\subsubsection[{mpt\-\_\-int\-\_\-constructor}]{\setlength{\rightskip}{0pt plus 5cm}void mpt\-\_\-int\-\_\-constructor (
\begin{DoxyParamCaption}
\item[{struct {\bf mpt\-\_\-int} $\ast$$\ast$}]{this}
\end{DoxyParamCaption}
)}}\label{cli_8c_a51f6e63945679154f6764eb315841011}
Constructor that allocates memory and initializes the structure of \char`\"{}interface up$|$down\char`\"{} command

\begin{DoxyNote}{Note}
This memory needs to deallocate after use. Use \hyperlink{cli_8c_a9643da81bdc75e4fbba500e2a6dff5e8}{mpt\-\_\-int\-\_\-destructor()}
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em this} & Pointer to an \char`\"{}mpt\-\_\-int $\ast$\char`\"{} variable \\
\hline
\end{DoxyParams}


Definition at line 27 of file cli.\-c.

\hypertarget{cli_8c_a9643da81bdc75e4fbba500e2a6dff5e8}{\index{cli.\-c@{cli.\-c}!mpt\-\_\-int\-\_\-destructor@{mpt\-\_\-int\-\_\-destructor}}
\index{mpt\-\_\-int\-\_\-destructor@{mpt\-\_\-int\-\_\-destructor}!cli.c@{cli.\-c}}
\subsubsection[{mpt\-\_\-int\-\_\-destructor}]{\setlength{\rightskip}{0pt plus 5cm}void mpt\-\_\-int\-\_\-destructor (
\begin{DoxyParamCaption}
\item[{struct {\bf mpt\-\_\-int} $\ast$$\ast$}]{this}
\end{DoxyParamCaption}
)}}\label{cli_8c_a9643da81bdc75e4fbba500e2a6dff5e8}
Destructor that deallocates memory after struct \hyperlink{structmpt__int}{mpt\-\_\-int} $\ast$ is no longer needed


\begin{DoxyParams}{Parameters}
{\em this} & Pointer to an \char`\"{}mpt\-\_\-int $\ast$\char`\"{} variable \\
\hline
\end{DoxyParams}


Definition at line 38 of file cli.\-c.

\hypertarget{cli_8c_ad8c4dc93e9bc191c65d5616602599ffd}{\index{cli.\-c@{cli.\-c}!parse\-\_\-cmd@{parse\-\_\-cmd}}
\index{parse\-\_\-cmd@{parse\-\_\-cmd}!cli.c@{cli.\-c}}
\subsubsection[{parse\-\_\-cmd}]{\setlength{\rightskip}{0pt plus 5cm}int parse\-\_\-cmd (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{cmd}
\end{DoxyParamCaption}
)}}\label{cli_8c_ad8c4dc93e9bc191c65d5616602599ffd}
Check C\-L\-I command syntax on client side to send out only valid commands


\begin{DoxyParams}{Parameters}
{\em cmd} & C\-L\-I command input \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
See \hyperlink{group___return_parser}{Parser Errors} 
\end{DoxyReturn}


Definition at line 299 of file cli.\-c.

\hypertarget{cli_8c_acc286b66b5b52e4d8d11e5f6990ce425}{\index{cli.\-c@{cli.\-c}!parser@{parser}}
\index{parser@{parser}!cli.c@{cli.\-c}}
\subsubsection[{parser}]{\setlength{\rightskip}{0pt plus 5cm}int parser (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{cmd, }
\item[{{\bf C\-M\-D\-T\-Y\-P\-E} $\ast$}]{rettype, }
\item[{void $\ast$$\ast$}]{ret}
\end{DoxyParamCaption}
)}}\label{cli_8c_acc286b66b5b52e4d8d11e5f6990ce425}
Function to parse C\-L\-I input and return command type and structure of parameters.


\begin{DoxyParams}{Parameters}
{\em cmd} & Input string which need to parse \\
\hline
{\em rettype} & Return the matched command. See \hyperlink{cli_8h_a8772ddb837dae62899db0754b7606766}{C\-M\-D\-T\-Y\-P\-E}. \\
\hline
{\em ret} & Return a struct for that command that contains the parsed arguments\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
P\-A\-R\-S\-E\-\_\-\-O\-K if the command and parameters seem ok, otherwise the code of parameter error. See \hyperlink{group___return_parser}{Parser Errors} for return values 
\end{DoxyReturn}
{\bfseries  C\-L\-I commands\-: }

$<$ mpt int\mbox{[}erface\mbox{]} I\-F \{up$|$down\}

$<$ mpt addr\mbox{[}ess\mbox{]} \{add$|$del\} I\-P\mbox{[}/\-P\-R\-E\-F\-I\-X\mbox{]} dev I\-F

$<$ mpt reload \mbox{[}F\-I\-L\-E\-N\-A\-M\-E\mbox{]}

$<$ mpt delete F\-I\-L\-E\-N\-A\-M\-E

$<$ mpt save \mbox{[}F\-I\-L\-E\-N\-A\-M\-E\mbox{]}

$<$ mpt path \{up$|$down\} S\-R\-C\-\_\-\-I\-P D\-S\-T\-\_\-\-I\-P

$<$ mpt show status 

Definition at line 131 of file cli.\-c.

\hypertarget{cli_8c_a4db0479001a6794462fb24b12192d397}{\index{cli.\-c@{cli.\-c}!save\-\_\-match@{save\-\_\-match}}
\index{save\-\_\-match@{save\-\_\-match}!cli.c@{cli.\-c}}
\subsubsection[{save\-\_\-match}]{\setlength{\rightskip}{0pt plus 5cm}void save\-\_\-match (
\begin{DoxyParamCaption}
\item[{char $\ast$$\ast$}]{dst, }
\item[{char $\ast$}]{src, }
\item[{regmatch\-\_\-t}]{pmatch}
\end{DoxyParamCaption}
)}}\label{cli_8c_a4db0479001a6794462fb24b12192d397}
Function that creates string from regular expression match

\begin{DoxyNote}{Note}
This function allocates memory for dst string that needs to deallocate after use, but it is done in the destructor functions.
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em dst} & Pointer to the newly allocated destination string \\
\hline
{\em src} & Original string which contains the matching string \\
\hline
{\em pmatch} & Which match need to be saved. N-\/th element of array return by regexec \par
 This contains index of the beginning and the end of the match \\
\hline
\end{DoxyParams}


Definition at line 112 of file cli.\-c.

